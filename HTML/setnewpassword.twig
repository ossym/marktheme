{% if site['resetPassword'] %}
<section class="bg-gradient-to-br from-slate-50 via-primary-50/30 to-accent-50/20 dark:from-dark dark:via-dark-secondary dark:to-dark transition-all duration-300 min-h-screen py-12 sm:py-16 lg:py-20 px-4 sm:px-6">
    <div class="container mx-auto max-w-2xl">
        <!-- Form Card -->
        <div class="bg-white/95 dark:bg-dark-secondary/95 backdrop-blur-sm rounded-2xl shadow-xl dark:shadow-2xl border border-gray-200/50 dark:border-dark-tertiary/50 p-6 sm:p-8 lg:p-10 transition-all duration-300 hover:shadow-2xl dark:hover:shadow-2xl hover:border-primary-200 dark:hover:border-primary-500/30 {% if site['rtl'] %} rtl-form {% endif %}">
            <!-- Header Section -->
            <div class="mb-6 sm:mb-8">
                <!-- Badge -->
                <div class="inline-flex items-center px-3 py-1.5 sm:px-4 sm:py-2 bg-primary-100 dark:bg-primary-900/30 border border-primary-200 dark:border-primary-500/30 rounded-full text-xs sm:text-sm font-medium text-primary-600 dark:text-primary-400 mb-4 shadow-sm">
                    <svg class="w-3 h-3 sm:w-4 sm:h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                    </svg>
                    Reset Password
                </div>
                
                <!-- Title -->
                <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 dark:text-slate-100 mb-3 leading-tight">
                    {{ lang('resetpassword.setnewpassword.title') }}
                </h2>
                
                <!-- Description -->
                <p class="text-sm sm:text-base text-gray-600 dark:text-slate-400">
                    Please enter your new password below. Make sure it's strong and secure.
                </p>
            </div>

            <form method="post" action="" class="space-y-6">
                <!-- Error Alert -->
                {% if error %}
                <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-500/30 text-red-800 dark:text-red-300 px-4 py-3 rounded-lg flex items-center justify-between {% if site['rtl'] %} rtl-alert {% endif %}" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                        </svg>
                        <span>{{ errorMessage }}</span>
                    </div>
                    <button type="button" class="text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 focus:outline-none flex-shrink-0 transition-colors" onclick="this.closest('.bg-red-50, .dark\\:bg-red-900\\/20').remove()" aria-label="Close error message">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
                {% endif %}

                <!-- Success Alert -->
                {% if success %}
                <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-500/30 text-green-800 dark:text-green-300 px-4 py-3 rounded-lg flex items-center justify-between {% if site['rtl'] %} rtl-alert {% endif %}" role="alert" aria-live="polite" aria-atomic="true">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                        </svg>
                        <span>{{ successText }}</span>
                    </div>
                    <button type="button" class="text-green-500 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300 focus:outline-none flex-shrink-0 transition-colors" onclick="this.closest('.bg-green-50, .dark\\:bg-green-900\\/20').remove()" aria-label="Close success message">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
                {% endif %}

                <!-- New Password Field -->
                <div>
                    <label for="password_new" class="block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2">
                        {{ lang('resetpassword.new_password') }}
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" aria-hidden="true">
                            <div class="rounded-md bg-primary-500 p-2">
                                <svg width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.7577 8.8284L15.6066 0.979492L17.0208 2.3937L15.6066 3.80791L18.0815 6.28279L16.6673 7.697L14.1924 5.22213L12.7782 6.63634L14.8995 8.7577L13.4853 10.1719L11.364 8.0506L9.1719 10.2426C10.4581 12.184 10.246 14.8254 8.5355 16.5358C6.58291 18.4885 3.41709 18.4885 1.46447 16.5358C-0.488158 14.5832 -0.488158 11.4174 1.46447 9.4648C3.17493 7.7543 5.81633 7.5422 7.7577 8.8284ZM7.1213 15.1216C8.2929 13.95 8.2929 12.0506 7.1213 10.879C5.94975 9.7074 4.05025 9.7074 2.87868 10.879C1.70711 12.0506 1.70711 13.95 2.87868 15.1216C4.05025 16.2932 5.94975 16.2932 7.1213 15.1216Z" fill="white"></path>
                                </svg>
                            </div>
                        </div>
                        <input 
                            type="password" 
                            id="password_new" 
                            name="ResetPasswordForm[password]" 
                            required
                            autocomplete="new-password"
                            aria-required="true"
                            aria-describedby="password-new-description"
                            class="appearance-none relative block w-full pl-14 pr-3 py-3 border border-primary-200 dark:border-primary-500/30 placeholder-gray-400 dark:placeholder-slate-500 text-gray-900 dark:text-slate-100 dark:bg-dark-tertiary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                            placeholder="{{ lang('resetpassword.new_password') }}"
                        >
                        <span id="password-new-description" class="sr-only">Enter your new password</span>
                    </div>
                </div>

                <!-- Confirm Password Field -->
                <div>
                    <label for="password_confirm" class="block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2">
                        {{ lang('resetpassword.confirm_new_password') }}
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" aria-hidden="true">
                            <div class="rounded-md bg-primary-500 p-2">
                                <svg width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.2577 8.8284L16.1066 0.979492L17.5208 2.3937L16.1066 3.80791L18.5815 6.28279L17.1673 7.697L14.6924 5.22213L13.2782 6.63634L15.3995 8.7577L13.9853 10.1719L11.864 8.0506L9.6719 10.2426C10.9581 12.184 10.746 14.8254 9.0355 16.5358C7.08291 18.4885 3.91709 18.4885 1.96447 16.5358C0.0118425 14.5832 0.0118425 11.4174 1.96447 9.4648C3.67493 7.7543 6.31633 7.5422 8.2577 8.8284ZM7.6213 15.1216C8.7929 13.95 8.7929 12.0506 7.6213 10.879C6.44975 9.7074 4.55025 9.7074 3.37868 10.879C2.20711 12.0506 2.20711 13.95 3.37868 15.1216C4.55025 16.2932 6.44975 16.2932 7.6213 15.1216Z" fill="white"></path>
                                </svg>
                            </div>
                        </div>
                        <input 
                            type="password" 
                            id="password_confirm" 
                            name="ResetPasswordForm[password_again]" 
                            required
                            autocomplete="new-password"
                            aria-required="true"
                            aria-describedby="password-confirm-description"
                            class="appearance-none relative block w-full pl-14 pr-3 py-3 border border-primary-200 dark:border-primary-500/30 placeholder-gray-400 dark:placeholder-slate-500 text-gray-900 dark:text-slate-100 dark:bg-dark-tertiary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                            placeholder="{{ lang('resetpassword.confirm_new_password') }}"
                        >
                        <span id="password-confirm-description" class="sr-only">Confirm your new password</span>
                    </div>
                </div>

                <!-- CSRF Token -->
                <input type="hidden" name="_csrf" value="{{csrftoken}}">

                <!-- Submit Button -->
                <div>
                    <button 
                        type="submit" 
                        class="group relative w-full flex justify-center items-center gap-2 py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-all shadow-md hover:shadow-lg transform hover:scale-[1.02] active:scale-100"
                        aria-label="Submit new password"
                    >
                        <span>{{ lang('resetpassword.button.submit') }}</span>
                        <img 
                            src="https://storage.perfectcdn.com/7gc9nb/terrzy6bnr147d9w.svg" 
                            alt=""
                            class="w-5 h-5 transition-transform group-hover:translate-x-1"
                        >
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

{% if site['captcha'] %}
<script src='https://www.google.com/recaptcha/api.js?hl={{ site['language'] }}'></script>
{% endif %}
{% endif %}


