<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto">
    <!-- Navigation Tabs -->
    <div class="mb-8">
      <nav class="flex space-x-1 bg-white dark:bg-gray-800 rounded-lg p-1 shadow-sm border border-gray-200 dark:border-gray-700">
        <a 
          href="{{ page_url('account') }}" 
          class="flex-1 px-4 py-2.5 text-sm font-medium text-center rounded-md transition-all duration-200 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"
        >
          {{ lang('account.tab.general') }}
        </a>
        <a 
          href="{{ page_url('notifications') }}" 
          class="flex-1 px-4 py-2.5 text-sm font-medium text-center rounded-md transition-all duration-200 bg-primary-600 text-white shadow-sm"
        >
          {{ lang('account.tab.notifications') }}
        </a>
      </nav>
    </div>

    <!-- Email Confirmation Card -->
    {% if confirmEmail.available %}
      <div class="mb-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <div class="p-6">
          <!-- Success Alert -->
          <div id="confirmEmailSuccess" class="hidden mb-4 p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 {% if site['rtl'] %} rtl-alert {% endif %}">
            <div class="flex items-start">
              <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div class="ml-3 flex-1">
                <p class="text-sm font-medium text-green-800 dark:text-green-200">
                  <!--- Success text --->
                </p>
              </div>
              <button type="button" class="ml-auto -mx-1.5 -my-1.5 inline-flex h-8 w-8 rounded-lg p-1.5 text-green-500 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors" onclick="this.parentElement.parentElement.classList.add('hidden')">
                <span class="sr-only">Dismiss</span>
                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- Error Alert -->
          <div id="confirmEmailError" class="hidden mb-4 p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 {% if site['rtl'] %} rtl-alert {% endif %}">
            <div class="flex items-start">
              <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-red-400" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div class="ml-3 flex-1">
                <p class="text-sm font-medium text-red-800 dark:text-red-200">
                  <!--- Error text --->
                </p>
              </div>
              <button type="button" class="ml-auto -mx-1.5 -my-1.5 inline-flex h-8 w-8 rounded-lg p-1.5 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors" onclick="this.parentElement.parentElement.classList.add('hidden')">
                <span class="sr-only">Dismiss</span>
                <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                </svg>
              </button>
            </div>
          </div>

          <div class="flex items-center mb-3">
            <div class="flex-shrink-0">
              <div class="flex items-center justify-center h-10 w-10 rounded-lg bg-primary-100 dark:bg-primary-900/30">
                <svg class="h-6 w-6 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
              </div>
            </div>
            <div class="ml-4 flex-1">
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                {{ lang('notifications.email_confirmation.title') }}
              </h3>
            </div>
          </div>
          
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-6">
            {{ lang('notifications.email_confirmation.description') }}
          </p>
          
          <form action="{{ confirmEmail.url }}" method="post">
            <input type="hidden" name="_csrf" value="{{ csrftoken }}">
            <button 
              type="submit" 
              class="w-full px-4 py-2.5 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"
            >
              {{ lang('notifications.email_confirmation.confirm') }}
            </button>
          </form>
        </div>
      </div>
    {% endif %}

    <!-- Telegram Connection Card -->
    {% if connectTelegram.available %}
      <div class="mb-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <div class="p-6">
          <div class="flex items-center mb-3">
            <div class="flex-shrink-0">
              <div class="flex items-center justify-center h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900/30">
                <svg class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </div>
            </div>
            <div class="ml-4 flex-1">
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                {{ lang('notifications.telegram.title') }}
              </h3>
            </div>
          </div>
          
          <form action="{{ connectTelegram.url }}" method="post">
            <input type="hidden" name="_csrf" value="{{ csrftoken }}">
            <button 
              type="submit" 
              class="w-full px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"
            >
              {{ lang('notifications.telegram.button') }}
            </button>
          </form>
        </div>
      </div>
    {% endif %}

    <!-- Notifications Settings Card -->
    {% if userNotifications['notifications']|length > 0 %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <div class="p-6">
          <!-- Error Alert -->
          {% if error %}
            <div class="mb-6 p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 {% if site['rtl'] %} rtl-alert {% endif %}">
              <div class="flex items-start">
                <div class="flex-shrink-0">
                  <svg class="h-5 w-5 text-red-400" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <div class="ml-3 flex-1">
                  <p class="text-sm font-medium text-red-800 dark:text-red-200">
                    {{ errorMessage }}
                  </p>
                </div>
              </div>
            </div>
          {% endif %}

          <!-- Success Alert -->
          {% if success %}
            <div class="mb-6 p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 {% if site['rtl'] %} rtl-alert {% endif %}">
              <div class="flex items-start">
                <div class="flex-shrink-0">
                  <svg class="h-5 w-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <div class="ml-3 flex-1">
                  <p class="text-sm font-medium text-green-800 dark:text-green-200">
                    {{ successText }}
                  </p>
                </div>
              </div>
            </div>
          {% endif %}

          <form action="" method="post">
            <!-- Responsive Table Container -->
            <div class="overflow-x-auto -mx-6 px-6">
              <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                <thead>
                  <tr class="bg-gray-50 dark:bg-gray-700/50">
                    <th scope="col" class="px-6 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                      {{ lang('notifications.title') }}
                    </th>
                    {% for sender in userNotifications['senders'] %}
                      <th scope="col" class="px-6 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                        {{ sender.name }}
                      </th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                  {% for notification in userNotifications['notifications'] %}
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150">
                      <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900 dark:text-white">
                          {{ notification['name'] }}
                        </div>
                      </td>
                      {% for sender in userNotifications['senders'] %}
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                          <span 
                            {% if sender['disabled'] %}
                              class="inline-block cursor-not-allowed opacity-60" 
                              data-toggle="tooltip" 
                              data-placement="top" 
                              title="{{ sender['tooltip'] }}"
                            {% else %}
                              class="inline-block"
                            {% endif %}
                          >
                            <input 
                              type="hidden" 
                              name="NotificationsForm[notifications][{{ sender['code'] }}][{{ notification['id'] }}]" 
                              value="0"
                            />
                            <label class="relative inline-flex items-center cursor-pointer">
                              <input 
                                type="checkbox" 
                                name="NotificationsForm[notifications][{{ sender['code'] }}][{{ notification['id'] }}]"
                                {% if notification['statuses'][sender['code']] %}checked="checked"{% endif %} 
                                {% if sender['disabled'] %}disabled{% endif %} 
                                value="1"
                                class="sr-only peer"
                              />
                              <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600 dark:peer-checked:bg-primary-600"></div>
                            </label>
                          </span>
                        </td>
                      {% endfor %}
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>

            <input type="hidden" name="_csrf" value="{{ csrftoken }}">
            
            {% if saveButtonAvailable %}
              <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                <button 
                  type="submit" 
                  class="w-full px-4 py-2.5 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg shadow-sm hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"
                >
                  {{ lang('notifications.save') }}
                </button>
              </div>
            {% endif %}
          </form>
        </div>
      </div>
    {% endif %}
  </div>
</div>